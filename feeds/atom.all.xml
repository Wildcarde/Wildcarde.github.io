<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Putting the Pieces Together</title><link href="https://blog.shadowgears.com/" rel="alternate"></link><link href="https://blog.shadowgears.com/feeds/atom.all.xml" rel="self"></link><id>https://blog.shadowgears.com/</id><updated>2021-04-11T02:10:00-04:00</updated><entry><title>Building the Blog</title><link href="https://blog.shadowgears.com/building-the-blog.html" rel="alternate"></link><published>2021-04-11T02:10:00-04:00</published><updated>2021-04-11T02:10:00-04:00</updated><author><name>Garrett McGrath</name></author><id>tag:blog.shadowgears.com,2021-04-11:/building-the-blog.html</id><summary type="html">&lt;p&gt;A rundown of how this blog is written, stored, and&amp;nbsp;published&lt;/p&gt;</summary><content type="html">&lt;p&gt;It&amp;#8217;s been a while since I&amp;#8217;ve spent any serious time looking at blogging, static site generation, and the github pages system so it was no surprise that my knowledge was more than a little out of date.  What was surprising however was how much information online seems to be equally out of date at this point a state that was a little disappointing but not overtly surprising.  It&amp;#8217;s not like github shouts from the rooftop when they change things quietly in the background, especially when those old approaches still&amp;nbsp;work.  &lt;/p&gt;
&lt;p&gt;So this post will serve somewhat as modern documentation for how github user pages can be setup and automated to use &lt;a href="https://blog.getpelican.com/"&gt;Pelican&lt;/a&gt; to generate a blog (like this&amp;nbsp;one).&lt;/p&gt;
&lt;h2 id="how-things-used-to-work"&gt;How things used to&amp;nbsp;work&lt;/h2&gt;
&lt;p&gt;Originally what you would do is create a public repository named &lt;code&gt;&amp;lt;githubuser&amp;gt;.github.io&lt;/code&gt;.  From here the &lt;code&gt;main&lt;/code&gt; or &lt;code&gt;master&lt;/code&gt; branch in the repository would be your raw content, so in pelican a folder full of markdown files.  From there you&amp;#8217;d generate an output folder, that typically you would not capture in git, and merge that into a separate branch named &lt;code&gt;gh-pages&lt;/code&gt;.  This felt like creating some sort of weird hell alternate file stream based approach and was generally kinda difficult to wrap your head around.  The alternative was brute forcing it by simply checking out two different copies of the same repo in separate folders, then just copy/pasting from one to the other and pushing.  This works but at that point, why have them be the same repo?  I suspect this is something github realized somewhere along the way because that&amp;#8217;s how you do it&amp;nbsp;now!&lt;/p&gt;
&lt;h2 id="structure"&gt;Structure&lt;/h2&gt;
&lt;p&gt;Github has simplified things a bit, now you can just put your websites static folder in the main branch (&lt;code&gt;main&lt;/code&gt; or &lt;code&gt;master&lt;/code&gt; depending on repo settings and age).  This allows us some flexibility, the core of this blog is published from a private repository allowing me to not exposed my pelican configs, comment cruft, in dev theme files, and other details around how pelican sites are published in the public repository that serves out what you are&amp;nbsp;reading.&lt;/p&gt;
&lt;p&gt;To get started I made a conda environment to use for local test builds, it&amp;#8217;s overkill but miniconda envs are my default approach, to this we need to add the following packages (this is the contents of my &lt;code&gt;requirements.txt&lt;/code&gt; file, but using the latest versions should work; you might not even need all of&amp;nbsp;this):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="na"&gt;blinker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=1.4&lt;/span&gt;
&lt;span class="na"&gt;docutils&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=0.16&lt;/span&gt;
&lt;span class="na"&gt;feedgenerator&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=1.9.1&lt;/span&gt;
&lt;span class="na"&gt;Jinja2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=2.11.3&lt;/span&gt;
&lt;span class="na"&gt;Markdown&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=3.2.2&lt;/span&gt;
&lt;span class="na"&gt;MarkupSafe&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=1.1.1&lt;/span&gt;
&lt;span class="na"&gt;pelican&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=4.5.4&lt;/span&gt;
&lt;span class="na"&gt;pelican-render-math&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=1.0.3&lt;/span&gt;
&lt;span class="na"&gt;Pygments&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=2.6.1&lt;/span&gt;
&lt;span class="na"&gt;python-dateutil&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;=2.8.1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After that environment is created and activated the private repo needs to be cloned into a local folder, and cd&amp;#8217;d into so it&amp;#8217;s your working directory. At this point the basic pelican environment can be created with the &lt;code&gt;pelican-quickstart&lt;/code&gt; command, this will create the default folder structure and config files needed to get everything running. Before adding and committing these changes add a quick &lt;code&gt;.gitignore&lt;/code&gt; file with the following&amp;nbsp;ignores:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;__pycache__&lt;/span&gt;
&lt;span class="na"&gt;.vscode&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="p"&gt;*&lt;/span&gt;

&lt;span class="nf"&gt;output&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="p"&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Once the above is added to git it can be committed and pushed up to the private repository.  This sets up the base you need to build on going&amp;nbsp;forward.&lt;/p&gt;
&lt;h3 id="custom-url"&gt;Custom &lt;span class="caps"&gt;URL&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;If using a custom url (like say &lt;code&gt;blog.shadowgears.com&lt;/code&gt;) you&amp;#8217;ll need to do a few&amp;nbsp;things:&lt;/p&gt;
&lt;p&gt;1) make a folder inside your &lt;code&gt;content&lt;/code&gt; folder named &lt;code&gt;extra&lt;/code&gt; and add a file named &lt;code&gt;CNAME&lt;/code&gt; with the custom domain name in it, that will handle the &lt;span class="caps"&gt;CNAME&lt;/span&gt; id file required by &lt;a href="https://docs.github.com/en/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site"&gt;github pages&lt;/a&gt;.&lt;br&gt;
2) Add the following to your &lt;code&gt;pelicanconf.py&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;STATIC_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;extra&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;extra/CNAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;#this flags these folders as &amp;#39;static&amp;#39; they will not be run through any parsers&lt;/span&gt;
&lt;span class="n"&gt;EXTRA_PATH_METADATA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;extra/CNAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CNAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="c1"&gt;#this takes the file and puts it at the root of the published directory and names it CNAME per the requirements in the github pages docs&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;3) Add the following to your &lt;code&gt;publishconf.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;SITEURL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://&amp;lt;your site url here&amp;gt;&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adding the above will ensure that the file &lt;code&gt;CNAME&lt;/code&gt; is placed in the root of your output folder every time the site is generated so even if it&amp;#8217;s removed by accident it&amp;#8217;ll be re-instated on the next publish.  Additionally setting the siteurl will make sure all internal links on the site point to the correct location when the site is&amp;nbsp;published.&lt;/p&gt;
&lt;h2 id="auto-publishing-posts"&gt;Auto Publishing&amp;nbsp;Posts&lt;/h2&gt;
&lt;p&gt;At this point you can publish the content, using the &lt;code&gt;make publish&lt;/code&gt; command will push a full processed copy of the content folder to &lt;code&gt;output&lt;/code&gt;, and for some that&amp;#8217;s probably anywhere between good and fine. But that&amp;#8217;s not something I want to have to remember every time I write something new, so the next step is to solve automatic publishing!  We&amp;#8217;ll be pushing from our private repository to the public one so we are going to need a &lt;a href="https://github.com/settings/tokens"&gt;personal access token&lt;/a&gt; with the &lt;code&gt;repo-&amp;gt;public repo&lt;/code&gt; privileges, I&amp;#8217;ve tested no additional privileges are required.  Make sure you note this key value down somewhere you can copy / paste&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;The next step is going to be adding this as a secret attached to your private repository, this is done in the specific private repos &lt;code&gt;settings-&amp;gt;secrets&lt;/code&gt;, simply add a new secret named &lt;code&gt;APITOKENPUBLISH&lt;/code&gt; and paste the contents of the generated token above in as the value. This will be used by the github action we&amp;#8217;ll be setting up&amp;nbsp;next.&lt;/p&gt;
&lt;p&gt;Now that we&amp;#8217;ve got the basics needed to make this work all that&amp;#8217;s required is adding the automatic workflow to the private repository.  This will be broken into a few&amp;nbsp;steps:&lt;/p&gt;
&lt;p&gt;1) Checkout a copy of the repository.&lt;br&gt;
2) Run &lt;code&gt;make publish&lt;/code&gt; on the contents of the repository.&lt;br&gt;
3) Clone the public repository into a separate location, copy the output of &lt;code&gt;make publish&lt;/code&gt; into it, and push it back&amp;nbsp;out.  &lt;/p&gt;
&lt;p&gt;To get this started we&amp;#8217;ll need a new set of folders at the root of the repository named &lt;code&gt;.github/workflows&lt;/code&gt;, inside here is where we&amp;#8217;ll place the rest of the magic.  Once that folder is in-place we are going to need a yaml file inside it, this can be named whatever but I&amp;#8217;m going for &lt;code&gt;pelican-publish.yml&lt;/code&gt;.  This is going to be a &lt;a href="https://docs.github.com/en/actions/quickstart"&gt;github actions&lt;/a&gt; file and is the reason we made that secret entry further up the post.  A full copy of the action file is included at the end of this post, the following sections break down the sub&amp;nbsp;parts.&lt;/p&gt;
&lt;h3 id="setup-the-environment"&gt;Setup the&amp;nbsp;Environment&lt;/h3&gt;
&lt;p&gt;This initial segment sets up some rules and the python environment.  We&amp;#8217;ll be naming the action &lt;code&gt;Pelican-Publisher&lt;/code&gt;, restricting it to only run on pushes to our source repository, and instructing it to run on ubuntu.  This last part we could probably make something lighter weight just so it runs a little faster (this process is slower than I&amp;#8217;d like) but for simplicity and compatibility with most published documentation and actions I stuck with ubuntu here.  The last bits of this step check out the private repository and creates a python&amp;nbsp;environment &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Pelican-Publisher&lt;/span&gt;

&lt;span class="c1"&gt;# Run this workflow ever time a new commit is pushed ot the repo&lt;/span&gt;
&lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;push&lt;/span&gt;

&lt;span class="nt"&gt;jobs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nt"&gt;publish&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Publish&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;runs-on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;ubuntu-latest&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;steps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;## pull the committed code into an environment.&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Checkout Code&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;actions/checkout@v2&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Set up Python 3.9&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;actions/setup-python@v2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;with&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;python-version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;3.9&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Install Dependencies&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p p-Indicator"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;python -m pip install --upgrade pip&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;pip install -r requirements.txt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="build-the-website"&gt;Build the&amp;nbsp;Website&lt;/h3&gt;
&lt;p&gt;This sounds like it should be long or complicated, it&amp;#8217;s neither.  If test &lt;code&gt;make publish&lt;/code&gt; commands worked on the local system the adding this to the above will build the website&amp;nbsp;fresh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Build Site&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p p-Indicator"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;make publish&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;If this doesn&amp;#8217;t work, there&amp;#8217;s probably an issue with your local &lt;code&gt;make publish&lt;/code&gt; or with your requirements file, verify those are correct then revisit&amp;nbsp;this.&lt;/p&gt;
&lt;h3 id="publish-the-website"&gt;Publish the&amp;nbsp;Website&lt;/h3&gt;
&lt;p&gt;The actual complicated part of this is here, we&amp;#8217;ll be making use of user &lt;a href="https://github.com/cpina"&gt;cpina&lt;/a&gt;&amp;#8216;s &lt;a href="https://github.com/cpina/github-action-push-to-another-repository"&gt;github-action-push-to-another-repository&lt;/a&gt; published action to do the heavy lifting here.  It&amp;#8217;ll require a few quick inputs, mostly involving your github &lt;span class="caps"&gt;ID&lt;/span&gt; or the afore mentioned &lt;span class="caps"&gt;API&lt;/span&gt; key&amp;nbsp;secret.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# push generated site to public repo&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Pushes to another repository&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;push_directory&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;cpina/github-action-push-to-another-repository@v1.2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;API_TOKEN_GITHUB&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;${{ secrets.APITOKENPUBLISH }}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;with&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;source-directory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;output&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;destination-github-username&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;your&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;github&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;id&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;here&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;destination-repository-name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;your&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;github&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;id&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;here&amp;gt;.github.io&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;user-email&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;&amp;lt;your email address here so the commit is signed correctly&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;commit-message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Automated Update&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;target-branch&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;main&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This action does a few things. First it checks out the target repository, in this case our public &lt;code&gt;&amp;lt;username&amp;gt;.github.io&lt;/code&gt; repository. Then it makes a new folder and copies just the &lt;code&gt;.git&lt;/code&gt; subfolder from the checked out repository into there. Over top of this it copies the contents of the folder &lt;code&gt;output&lt;/code&gt;, and finally issues a commit and push of this newly minted git&amp;nbsp;repository.&lt;/p&gt;
&lt;p&gt;Doing it this way is important in that it ensures you have a completely clean copy of the generated output as your new website version instead of possibly missing an article deletion or restructuring that doesn&amp;#8217;t get tracked&amp;nbsp;properly.&lt;/p&gt;
&lt;h3 id="putting-it-all-together"&gt;Putting it all&amp;nbsp;together&lt;/h3&gt;
&lt;p&gt;This is the full action file ready to be copy/pasted and updated to your own&amp;nbsp;settings.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Pelican-Publisher&lt;/span&gt;

&lt;span class="c1"&gt;# Run this workflow ever time a new commit is pushed ot the repo&lt;/span&gt;
&lt;span class="nt"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;push&lt;/span&gt;

&lt;span class="nt"&gt;jobs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nt"&gt;publish&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Publish&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;runs-on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;ubuntu-latest&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;steps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;## pull the committed code into an environment.&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Checkout Code&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;actions/checkout@v2&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Set up Python 3.9&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;actions/setup-python@v2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;with&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;python-version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;3.9&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Install Dependencies&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p p-Indicator"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;python -m pip install --upgrade pip&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;pip install -r requirements.txt&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Build Site&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p p-Indicator"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="no"&gt;make publish&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# push generated site to public repo&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Pushes to another repository&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;push_directory&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;uses&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;cpina/github-action-push-to-another-repository@v1.2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;env&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;API_TOKEN_GITHUB&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;${{ secrets.APITOKENPUBLISH }}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;with&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;source-directory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;output&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;destination-github-username&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;your&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;github&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;id&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;here&amp;gt;&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;destination-repository-name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;lt;your&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;github&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;id&lt;/span&gt;&lt;span class="nv"&gt; &lt;/span&gt;&lt;span class="s"&gt;here&amp;gt;.github.io&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;user-email&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;&amp;lt;your email address here so the commit is signed correctly&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;commit-message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;Automated Update&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="nt"&gt;target-branch&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;main&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="adding-content"&gt;Adding&amp;nbsp;Content&lt;/h2&gt;
&lt;p&gt;In the process of writing this article I&amp;#8217;ve gone from using VSCode to write it, to moving to &lt;span class="caps"&gt;ZETTLR&lt;/span&gt;, and then switching back to vscode for a few reasons.  Initially when I was developing this article in vscode I&amp;#8217;d attempted to install a spell checker to make sure my writing is at least spelled right if not you know, comprehensible.  Unfortunately the recommended spell checker just seemed to freak out and highlight the entire markdown file as spelled incorrectly.  So I removed that addon and migrated over to editing in a zettlr window, this has some upsides I really liked. The spell checking is sane, rendering markdown &amp;#8216;live&amp;#8217; as you edit it works incredibly well.  Unfortunately the folder handling is rather clunky, zettlr has opinions about how things are organized and they don&amp;#8217;t mesh with how I work as well as I thought.  Additionally the linux version seems to have some serious keyboard shortcut collisions that I didn&amp;#8217;t have the willpower to fix; when you are trying to paste with &lt;code&gt;ctrl+v&lt;/code&gt; and it instead keeps warping you to the bottom of the page for some reason, it&amp;#8217;s time to stop fighting a tool not setup to do what you want. So I&amp;#8217;m back to using vscode as my editor, however in the mean time I&amp;#8217;ve found a different spellchecker for vscode that acts more sanely.  The &lt;a href="https://marketplace.visualstudio.com/items?itemName=streetsidesoftware.code-spell-checker"&gt;Code Spell Checker&lt;/a&gt; by Street Side Software works more or less how I&amp;#8217;d expect. The only nagging point currently is having to hit &lt;code&gt;ctrl+.&lt;/code&gt; instead of right clicking on a misspelled word in order to fix it.  All in all, it works and that&amp;#8217;s what&amp;#8217;s important&amp;nbsp;here.&lt;/p&gt;
&lt;h2 id="notes"&gt;Notes&lt;/h2&gt;
&lt;p&gt;Below are notes and references used to work out the details&amp;nbsp;above.&lt;/p&gt;
&lt;p&gt;This blog is built and published using the &lt;a href="https://docs.getpelican.com/en/3.6.3/index.html"&gt;Pelican static site generator system&lt;/a&gt; in a two stage&amp;nbsp;setup.&lt;/p&gt;
&lt;p&gt;reference material on the current state of github&amp;nbsp;pages:&lt;/p&gt;
&lt;p&gt;actions reference&amp;nbsp;materials:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;https://github.com/marketplace/actions/push-directory-to-another-repository&lt;/li&gt;
&lt;li&gt;https://github.com/cpina/push-to-another-repository-example&lt;/li&gt;
&lt;li&gt;https://nolanbconaway.github.io/pelican-deploy-gh-actions/pages/deployment-on-github-pages.html&lt;/li&gt;
&lt;li&gt;https://docs.github.com/en/actions/quickstart&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;currently using: github actions based on ubuntu-latest, python setup commands, and the push directory to another repository&amp;nbsp;action.&lt;/p&gt;</content><category term="HowTo"></category><category term="deployment"></category><category term="blog"></category></entry><entry><title>Glass Canopy Campaign, Report 0</title><link href="https://blog.shadowgears.com/glasscanopy-campaign-report-0.html" rel="alternate"></link><published>2021-02-15T16:30:00-05:00</published><updated>2021-02-15T16:30:00-05:00</updated><author><name>Garrett McGrath</name></author><id>tag:blog.shadowgears.com,2021-02-15:/glasscanopy-campaign-report-0.html</id><summary type="html">&lt;p&gt;Campaign setup and initial adventure&amp;nbsp;report.&lt;/p&gt;</summary><content type="html">&lt;!-- Status: Draft --&gt;

&lt;p&gt;This document serves as a starting record of the adventures and misadventures of the Luna Invictus adventuring troop and their allies in the Scaleshorn Union.  The Scaleshorn Union operates out of the freeport city of Gillamoore acting a mixture of investigator, mercenary, and heroes for hire.  Luna Invictus&amp;#8217;s inaugural mission found them investigating the source of several lost shipments of goods, from a small farming village to the city at the behest of a local trader.  And coming home with more than they bargained&amp;nbsp;for.&lt;/p&gt;
&lt;h2 id="haki-after-action-report"&gt;Haki: After Action&amp;nbsp;Report&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Initially the group and client go off on an.. odd foot due to Kaelin&amp;#8217;s frankly inexplicable decision to burn the clients admittedly disabled cart. Who burns a&amp;nbsp;cart!?&lt;/li&gt;
&lt;li&gt;The tenor seems to have improved when they managed to deliver him safely to the town and eliminated a set of darklings preparing to attack the town. During the next day the group split up to investigate an array of strange incidents around the area including several incidents of theft, sabotage, and damaging crops.  During the course of the investigation two factions are discovered to be at play.  The previously encountered darklings, and a troup of modrons; both operating under unknown&amp;nbsp;circumstances.&lt;/li&gt;
&lt;li&gt;Merla, Dath, and Feather discovered the modrons while investigating an apparent attack at one of the farmsteads, pursuing them to recover a small child trapped in a crystal&amp;nbsp;shell.&lt;/li&gt;
&lt;li&gt;Kaelin, Fang, and a local named Johns meanwhile encounter and dispatch most of the darklings before they can cause more issues.  Many of the stolen supplies were found in a small cave the darklings used as a hideout while operating in the&amp;nbsp;area.&lt;/li&gt;
&lt;li&gt;That evening the remaining darklings attack attempting to abscond with the child. All but one were eliminated and the last was released to flee before the sun turned it to&amp;nbsp;ash.&lt;/li&gt;
&lt;li&gt;Johns accompanied the group back back to Gillamoore to be evaluated for membership in the Scaleshorn&amp;nbsp;Union.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="conclusions"&gt;Conclusions&lt;/h3&gt;
&lt;p&gt;It appears highly likely both groups were hunting the child in the crystal shell, the stasis isolation the boy was placed in implies a possible physical threat; or simply attempting to deliver the boy unharmed to their masters.  Several possible guild resources could provide insight on the nature of the nature of this crystal encasement and whether the child is even alive, but I suspect there will be no quick answers on who or what was truly after&amp;nbsp;him.&lt;/p&gt;
&lt;h2 id="client-feedback"&gt;Client&amp;nbsp;Feedback&lt;/h2&gt;
&lt;p&gt;Why would you burn a cart? This is coming out of your fee!&lt;br&gt;
The cart incident aside, once the child was removed from the area neither group appears to have returned and the town has returned to it&amp;#8217;s quiet existence.  While their methods may be questionable, overall your subordinated did their job protecting the town&amp;nbsp;effectively.&lt;/p&gt;
&lt;h2 id="opposition"&gt;Opposition&lt;/h2&gt;
&lt;p&gt;Raif, the information you have gleaned is most useful but failure will not be tolerated. It is clear some reconditioning is required, you will report to the tanks for&amp;nbsp;revision.&lt;/p&gt;</content><category term="Glass Canopy"></category><category term="Glass Canopy"></category><category term="DND"></category></entry></feed>